
<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>jiraCore &#8212; jiraCore 1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../_static/bizstyle.css?v=5283bb3d" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    
    <script src="../_static/documentation_options.js?v=29a6c3e3"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">jiraCore 1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">jiraCore</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for jiraCore</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jmespath</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jq</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">requests.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTTPBasicAuth</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">mimetypes</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">loguru</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">jiraVariables</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jvars</span>


<div class="viewcode-block" id="JiraAPI">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">JiraAPI</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides functionality to interact with the Jira API for various operations such as user and</span>
<span class="sd">    project management, issue tracking, and search functionalities.</span>

<span class="sd">    This class is designed to handle authentication, make REST API calls to Jira, and manage</span>
<span class="sd">    application-wide headers. The purpose is to abstract Jira&#39;s API calls and simplify usage for</span>
<span class="sd">    Jira users and projects.</span>

<span class="sd">    :ivar jvars: Reference to the JiraVariables instance for configuration data.</span>
<span class="sd">    :type jvars: JiraVariables</span>
<span class="sd">    :ivar base_url: The base URL for Jira API requests.</span>
<span class="sd">    :type base_url: str</span>
<span class="sd">    :ivar _auth: Authentication credentials for Jira API calls.</span>
<span class="sd">    :type _auth: HTTPBasicAuth</span>
<span class="sd">    :ivar default_issue_type_id: The default issue type identifier for Jira issues.</span>
<span class="sd">    :type default_issue_type_id: str</span>
<span class="sd">    :ivar default_priority_id: The default priority identifier for Jira issues.</span>
<span class="sd">    :type default_priority_id: str</span>
<span class="sd">    :ivar headers: Standard headers used for HTTP requests to the Jira API.</span>
<span class="sd">    :type headers: dict</span>
<span class="sd">    :ivar default_project_key: The default key of the Jira project being used.</span>
<span class="sd">    :type default_project_key: str</span>
<span class="sd">    :ivar logger: Logger instance for managing log records.</span>
<span class="sd">    :type logger: Logger</span>
<span class="sd">    :ivar project_info: Details of the Jira project.</span>
<span class="sd">    :type project_info: dict</span>
<span class="sd">    :ivar project_id: Identifier of the Jira project currently being worked on.</span>
<span class="sd">    :type project_id: str</span>
<span class="sd">    :ivar user_account_id: Account ID of the authenticated user.</span>
<span class="sd">    :type user_account_id: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor to initialize JiraAPI instance.</span>
<span class="sd">        :param project_key: Optional. The Jira project key. If not provided, the default project key will be used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jvars</span> <span class="o">=</span> <span class="n">jvars</span><span class="o">.</span><span class="n">JiraVariables</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_logger</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jvars</span><span class="o">.</span><span class="n">base_jira_url</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auth</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_issue_type_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jvars</span><span class="o">.</span><span class="n">default_issue_type_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_priority_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jvars</span><span class="o">.</span><span class="n">default_priority_id</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span> <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auth</span> <span class="o">=</span> <span class="n">HTTPBasicAuth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jvars</span><span class="o">.</span><span class="n">jira_user_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">jvars</span><span class="o">.</span><span class="n">_jira_password</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_authenticated_headers</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authenticate</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">project_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_project_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jvars</span><span class="o">.</span><span class="n">default_project_key</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_project_key</span> <span class="o">=</span> <span class="n">project_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_project_key</span><span class="p">)</span>


<div class="viewcode-block" id="JiraAPI.init_logger">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.init_logger">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">init_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">LOGGER_LEVEL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jvars</span><span class="o">.</span><span class="n">log_level</span>
        <span class="n">CONSOLE_LEVEL</span> <span class="o">=</span> <span class="s1">&#39;DEBUG&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jvars</span><span class="o">.</span><span class="n">log_location</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s2">&quot;30 MB&quot;</span><span class="p">,</span> <span class="n">retention</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">enqueue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">LOGGER_LEVEL</span><span class="p">)</span>
        <span class="n">time_format</span> <span class="o">=</span> <span class="s2">&quot;YYYY-MM-DD HH:mm:ss&quot;</span>
        <span class="n">console_format</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;green&gt;</span><span class="se">{{</span><span class="s2">time:</span><span class="si">{</span><span class="n">time_format</span><span class="si">}</span><span class="se">}}</span><span class="s2">&lt;/green&gt; | &lt;level&gt;</span><span class="se">{{</span><span class="s2">level: &lt;8</span><span class="se">}}</span><span class="s2">&lt;/level&gt; | </span><span class="se">{{</span><span class="s2">name</span><span class="se">}}</span><span class="s2">:</span><span class="se">{{</span><span class="s2">function</span><span class="se">}}</span><span class="s2">:</span><span class="se">{{</span><span class="s2">line</span><span class="se">}}</span><span class="s2"> - </span><span class="se">{{</span><span class="s2">message</span><span class="se">}}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sink</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span>
                   <span class="n">level</span><span class="o">=</span><span class="n">CONSOLE_LEVEL</span><span class="p">,</span>
                   <span class="nb">format</span><span class="o">=</span><span class="n">console_format</span><span class="p">,</span>
                   <span class="n">colorize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_set_authenticated_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets headers to authenticate the request using an experimental API.</span>

<span class="sd">        This private method is used internally to add authentication headers specific</span>
<span class="sd">        to the experimental API, enabling proper communication with the server.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-ExperimentalAPI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;opt-in&quot;</span>

<div class="viewcode-block" id="JiraAPI.authenticate">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.authenticate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Authenticates the user by sending a GET request to the specified API endpoint</span>
<span class="sd">        using the base URL and provided credentials. This method captures the response,</span>
<span class="sd">        logs the status and user information on successful authentication, and updates</span>
<span class="sd">        the ``user_account_id`` attribute. It handles exceptions, logs errors, and</span>
<span class="sd">        returns appropriate status codes on failure.</span>

<span class="sd">        :raises requests.exceptions.HTTPError: If an HTTP exception occurs during the</span>
<span class="sd">            request.</span>
<span class="sd">        :raises Exception: For any other unexpected failures during the execution.</span>

<span class="sd">        :return: A tuple containing the status code (int) and an error message (str)</span>
<span class="sd">            on failure, or the status code (int) alone on success.</span>
<span class="sd">        :rtype: int or tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/myself&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Authentication: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">user_info</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_account_id</span> <span class="o">=</span> <span class="n">user_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;accountId&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">14.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Authentication failed: </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">errh</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">14</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Authentication failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span></div>

        
<div class="viewcode-block" id="JiraAPI.project_info">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.project_info">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">project_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves project information from a given project key by calling a REST API endpoint.</span>
<span class="sd">        It processes the response to extract necessary project details, such as project ID,</span>
<span class="sd">        logs critical debug and error information, and handles exceptions.</span>

<span class="sd">        :param project_key: Unique identifier of the project for which information is being retrieved.</span>
<span class="sd">        :type project_key: str</span>
<span class="sd">        :return: The status code of the HTTP request. For exceptions, it returns a custom negative</span>
<span class="sd">            status code.</span>
<span class="sd">        :rtype: int or tuple(int, str)</span>
<span class="sd">        :raises requests.exceptions.HTTPError: Raised when the HTTP request fails due to a</span>
<span class="sd">            non-success status code.</span>
<span class="sd">        :raises Exception: Raised for all other unexpected errors during the request or processing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/project/</span><span class="si">{</span><span class="n">project_key</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">project_info</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">project_id</span> <span class="o">=</span> <span class="n">jq</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">project_info</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Project Key: </span><span class="si">{</span><span class="n">project_key</span><span class="si">}</span><span class="s2">; Status Code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Result: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">project_info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">16.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving project info. Project Key: </span><span class="si">{</span><span class="n">project_key</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">errh</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">project_id</span> <span class="o">=</span> <span class="s1">&#39;-1&#39;</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">16</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving project info. Project Key: </span><span class="si">{</span><span class="n">project_key</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span></div>


<div class="viewcode-block" id="JiraAPI.user_info">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.user_info">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">user_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve information about a user from Jira using their account ID.</span>

<span class="sd">        This method interacts with the Jira REST API to fetch user information based on the provided</span>
<span class="sd">        account ID. It returns a named tuple containing the response status code, user data, whether</span>
<span class="sd">        or not the user was found, user email address, display name, and activity status. If the</span>
<span class="sd">        specified user is not found or an error occurs during the API request, appropriate responses</span>
<span class="sd">        are logged and returned to the caller.</span>

<span class="sd">        :param account_id: The Jira account ID of the user whose details are to be fetched.</span>
<span class="sd">        :type account_id: str</span>

<span class="sd">        :returns: On success, a named tuple containing:</span>
<span class="sd">                  - status_code (int): HTTP response code from the Jira API.</span>
<span class="sd">                  - jira_user_dict (dict): Dictionary containing user information.</span>
<span class="sd">                  - jira_user_found (int): Indicator whether the user was found (1 if found, 0 otherwise).</span>
<span class="sd">                  - jira_user_email (str): Email address of the user.</span>
<span class="sd">                  - jira_user_display_name (str): Display name of the user.</span>
<span class="sd">                  - jira_user_active (bool): Active status of the user.</span>
<span class="sd">                  On failure, varies as:</span>
<span class="sd">                  - For HTTP request errors, returns a tuple (status_code: float, error_message: str).</span>
<span class="sd">                  - For other exceptions, returns the named tuple with status_code -17 and appropriate default</span>
<span class="sd">                    values.</span>
<span class="sd">        :rtype: Union[namedtuple, Tuple[float, str]]</span>

<span class="sd">        :raises requests.exceptions.HTTPError: If the HTTP request to Jira fails due to response errors.</span>
<span class="sd">        :raises Exception: If any other exception occurs during the execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">user_info</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;user_info&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;status_code&quot;</span><span class="p">,</span> <span class="s2">&quot;jira_user_dict&quot;</span><span class="p">,</span> <span class="s2">&quot;jira_user_found&quot;</span><span class="p">,</span> <span class="s2">&quot;jira_user_email&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;jira_user_display_name&quot;</span><span class="p">,</span> <span class="s2">&quot;jira_user_active&quot;</span><span class="p">])</span>
        <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;accountId&#39;</span><span class="p">:</span> <span class="n">account_id</span><span class="p">}</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/user&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="n">user_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">user_data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Account ID: </span><span class="si">{</span><span class="n">account_id</span><span class="si">}</span><span class="s2">; Status Code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Result: </span><span class="si">{</span><span class="n">user_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">user_info</span><span class="p">(</span>
                    <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">user_data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">user_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;emailAddress&quot;</span><span class="p">),</span> <span class="n">user_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;displayName&quot;</span><span class="p">),</span> <span class="n">user_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;active&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User not found. Account ID: </span><span class="si">{</span><span class="n">account_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">user_info</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="p">{},</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">17.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving user info. Account ID: </span><span class="si">{</span><span class="n">account_id</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">errh</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">17</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving user info. Account ID: </span><span class="si">{</span><span class="n">account_id</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">user_info</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="p">{},</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="JiraAPI.user_by_email">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.user_by_email">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">user_by_email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email_address</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves user information based on the given email address by querying the Jira API. The system will validate</span>
<span class="sd">        the email address format before sending the data request. If the email address format is invalid, the method</span>
<span class="sd">        immediately logs the error and returns a structured tuple with a specific error code. If the request to the</span>
<span class="sd">        API is successful, the method returns the first user matching the provided email address. Logging is utilized</span>
<span class="sd">        throughout the process to provide detailed runtime diagnostics.</span>

<span class="sd">        :param email_address: An email address string to query the Jira API for user information.</span>
<span class="sd">        :type email_address: str</span>
<span class="sd">        :return: A named tuple containing:</span>
<span class="sd">            -status_code</span>
<span class="sd">            -jira_user_dict: a dictionary of user information (or an empty dictionary if not found)</span>
<span class="sd">            -jira_user_found: flag indicating if the user was found (1 for found, 0 for not found, -1 for errors).</span>
<span class="sd">        :rtype: tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">user_info</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;user_info&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;status_code&quot;</span><span class="p">,</span> <span class="s2">&quot;jira_user_dict&quot;</span><span class="p">,</span> <span class="s2">&quot;jira_user_found&quot;</span><span class="p">])</span>

        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[a-z0-9]+[\._]?[a-z0-9]+[@]\w+[.]\w+$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">email_address</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">18.1</span>
            <span class="n">jira_user_found</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">jira_user_dict</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Invalid email address. Email Address: </span><span class="si">{</span><span class="n">email_address</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">user_info</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="p">{},</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/user/search/?query=</span><span class="si">{</span><span class="n">email_address</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">)</span>
                <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
                <span class="n">user_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Email Address: </span><span class="si">{</span><span class="n">email_address</span><span class="si">}</span><span class="s2">; Status Code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Result: </span><span class="si">{</span><span class="n">user_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">user_data</span><span class="p">:</span>
                    <span class="n">jira_user_dict</span> <span class="o">=</span> <span class="n">user_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">jira_user_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;avatarUrls&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">user_info</span><span class="p">(</span>
                        <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">jira_user_dict</span><span class="p">,</span> <span class="mi">1</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User not found. Email Address: </span><span class="si">{</span><span class="n">email_address</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">user_info</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="p">{},</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
                <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">18.1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving user info. Email Address: </span><span class="si">{</span><span class="n">email_address</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">status_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">errh</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">18</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving user info. Email Address: </span><span class="si">{</span><span class="n">email_address</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">user_info</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="p">{},</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="JiraAPI.search_issues">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.search_issues">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">search_issues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_query</span><span class="p">,</span> <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Executes a search query against the Jira API to retrieve issues based on the provided JQL.</span>

<span class="sd">        The function returns the issues either in raw format or as a DataFrame based on the input flag.</span>
<span class="sd">        HTTP errors and general exceptions are handled, with relevant error messages logged.</span>
<span class="sd">        The returned data is encapsulated into a named tuple containing the response details.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            search_query (str): The JQL (Jira Query Language) expression used to retrieve issues from Jira.</span>
<span class="sd">            as_dataframe (bool): A flag indicating whether the response should be returned as a pandas DataFrame.</span>
<span class="sd">                Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            collections.namedtuple: A named tuple containing the following elements:</span>
<span class="sd">                - `status_code` (int): The HTTP status code of the API response.</span>
<span class="sd">                - `jira_issues` (list | pandas.DataFrame): The retrieved issues, returned as raw JSON (list) or</span>
<span class="sd">                  as a pandas DataFrame depending on the value of `as_dataframe`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            requests.exceptions.HTTPError: If the API request fails with an HTTP error.</span>
<span class="sd">            Exception: For general unexpected errors.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">IssueSearchResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;issue_search_results&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;status_code&quot;</span><span class="p">,</span> <span class="s2">&quot;jira_issues&quot;</span><span class="p">])</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/search?jql=</span><span class="si">{</span><span class="n">search_query</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="n">result_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Search query: </span><span class="si">{</span><span class="n">search_query</span><span class="si">}</span><span class="s2">; Result: </span><span class="si">{</span><span class="n">result_dict</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">as_dataframe</span><span class="p">:</span>
                <span class="n">jira_issues</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">record_path</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;issues&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">jira_issues</span> <span class="o">=</span> <span class="n">result_dict</span>
            <span class="k">return</span> <span class="n">IssueSearchResult</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">jira_issues</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">21.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error searching for issues. Query: </span><span class="si">{</span><span class="n">search_query</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">errh</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">21</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error searching for issues. Query: </span><span class="si">{</span><span class="n">search_query</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">IssueSearchResult</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="p">[])</span></div>


<div class="viewcode-block" id="JiraAPI.issue_create">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.issue_create">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">issue_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">project_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">issue_type_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">assignee</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a Jira issue.</span>

<span class="sd">        This function interacts with the Jira API to create an issue in a specified project.</span>

<span class="sd">        :param project_id: The ID of the project where the issue will be created.</span>
<span class="sd">        :type project_id: str</span>
<span class="sd">        :param summary: The summary (short description) of the issue.</span>
<span class="sd">        :type summary: str</span>
<span class="sd">        :param issue_type_id: The type of issue to create (default: 12412).</span>
<span class="sd">        :type issue_type_id: int, optional</span>
<span class="sd">        :param description: A longer description of the issue, optional.</span>
<span class="sd">        :type description: str, optional</span>
<span class="sd">        :param assignee: The account ID of the person to assign the issue to, optional.</span>
<span class="sd">        :type assignee: str, optional</span>
<span class="sd">        :param priority: The priority of the issue (default: 10100), optional.</span>
<span class="sd">        :type priority: int, optional</span>
<span class="sd">        :return: A namedtuple representing the created issue with the fields:</span>
<span class="sd">                 - `status_code` (int): The HTTP status code of the response.</span>
<span class="sd">                 - `issue_info` (dict): Additional information about the created issue.</span>
<span class="sd">                 - `id` (str): The ID of the newly created issue.</span>
<span class="sd">                 - `key` (str): The Jira key of the created issue (e.g., &quot;PROJECT-123&quot;).</span>
<span class="sd">                 - `issue_url` (str): The URL of the created issue in Jira.</span>
<span class="sd">        :rtype: namedtuple(&quot;issue&quot;, [&quot;status_code&quot;, &quot;issue_info&quot;, &quot;id&quot;, &quot;key&quot;, &quot;issue_url&quot;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">IssueInfo</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;issue&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;status_code&quot;</span><span class="p">,</span> <span class="s2">&quot;issue_info&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;issue_url&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">project_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">project_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_id</span>
        <span class="k">if</span> <span class="n">issue_type_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">issue_type_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_issue_type_id</span>
        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">assignee</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">assignee</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_account_id</span>
        <span class="k">if</span> <span class="n">priority</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">priority</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_priority_id</span>
        <span class="n">priority</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">priority</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
        <span class="n">input_json</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;assignee&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;accountId&quot;</span><span class="p">:</span> <span class="n">assignee</span><span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">}],</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;paragraph&quot;</span><span class="p">}</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;doc&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="s2">&quot;issuetype&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">issue_type_id</span><span class="p">},</span>
                <span class="c1">#&quot;priority&quot;: {&quot;id&quot;: priority},</span>
                <span class="s2">&quot;project&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">project_id</span><span class="p">},</span>
                <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="n">summary</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">input_json</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/issue&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="n">issue_info</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Issue created: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Project: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">; Summary: </span><span class="si">{</span><span class="n">summary</span><span class="si">}</span><span class="s2">; Issue Type: </span><span class="si">{</span><span class="n">issue_type_id</span><span class="si">}</span><span class="s2">; Priority: </span><span class="si">{</span><span class="n">priority</span><span class="si">}</span><span class="s2">; Assignee: </span><span class="si">{</span><span class="n">assignee</span><span class="si">}</span><span class="s2">; &quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">IssueInfo</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">issue_info</span><span class="p">,</span> <span class="n">issue_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">),</span> <span class="n">issue_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">),</span> <span class="n">issue_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;self&quot;</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">35.1</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error creating issue; Project: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">; Summary: </span><span class="si">{</span><span class="n">summary</span><span class="si">}</span><span class="s2">; Issue Type: </span><span class="si">{</span><span class="n">issue_type_id</span><span class="si">}</span><span class="s2">; Priority: </span><span class="si">{</span><span class="n">priority</span><span class="si">}</span><span class="s2">; Assignee: </span><span class="si">{</span><span class="n">assignee</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">IssueInfo</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="p">[],</span> <span class="o">-</span><span class="mi">1</span> <span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">35</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error creating issue; Project: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">; Summary: </span><span class="si">{</span><span class="n">summary</span><span class="si">}</span><span class="s2">; Issue Type: </span><span class="si">{</span><span class="n">issue_type_id</span><span class="si">}</span><span class="s2">; Priority: </span><span class="si">{</span><span class="n">priority</span><span class="si">}</span><span class="s2">; Assignee: </span><span class="si">{</span><span class="n">assignee</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">IssueInfo</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="p">[],</span> <span class="o">-</span><span class="mi">1</span> <span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="JiraAPI.issue_transition">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.issue_transition">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">issue_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">issue_id</span><span class="p">,</span> <span class="n">transition_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transitions a specified issue in a project management system to a new state using</span>
<span class="sd">        a provided transition ID. This involves making a POST request to the system&#39;s API</span>
<span class="sd">        while handling potential exceptions and logging outcomes.</span>

<span class="sd">        :param issue_id: Identifier for the issue to be transitioned.</span>
<span class="sd">        :type issue_id: str</span>
<span class="sd">        :param transition_id: Identifier for the transition to apply to the issue.</span>
<span class="sd">        :type transition_id: str</span>
<span class="sd">        :return: Status code of the API response, or custom error status codes for</span>
<span class="sd">                 exceptional conditions (-37 or -37.1).</span>

<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;transition&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">transition_id</span><span class="p">}})</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/issue/</span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s1">/transitions&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Issue transitioned: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Transition ID: </span><span class="si">{</span><span class="n">transition_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">37.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error transitioning issue. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Transition ID: </span><span class="si">{</span><span class="n">transition_id</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">37</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error transitioning issue. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Transition ID: </span><span class="si">{</span><span class="n">transition_id</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span></div>


<div class="viewcode-block" id="JiraAPI.issue_field_update">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.issue_field_update">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">issue_field_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">issue_id</span><span class="p">,</span> <span class="n">field_update_dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the fields of a specific issue in the issue tracking system by sending</span>
<span class="sd">        a PUT request to the API endpoint. This method allows updating multiple fields</span>
<span class="sd">        at once by providing a dictionary of field names and their corresponding new</span>
<span class="sd">        values.</span>

<span class="sd">        If the update operation is successful, it logs the changes and returns the</span>
<span class="sd">        HTTP response status code. In case of an HTTP error or other exceptions, it logs</span>
<span class="sd">        the appropriate error details and returns specific negative status codes to</span>
<span class="sd">        indicate failure.</span>

<span class="sd">        :param issue_id: The unique identifier of the issue to be updated.</span>
<span class="sd">        :type issue_id: str</span>
<span class="sd">        :param field_update_dict: Dictionary containing the fields to update</span>
<span class="sd">            and their new values. The keys in the dictionary represent the field</span>
<span class="sd">            names, and the values represent the new data for those fields.</span>
<span class="sd">            Example: field_update_data = {&quot;customfield_14064&quot;: [{&quot;accountId&quot;: &quot;712020:d4f13f91-ed7f-493d-8fef-4029b44eb7cb&quot;},{&quot;accountId&quot;: &quot;5a4e734573cadb08a03ed16c&quot;}]}</span>
<span class="sd">        :type field_update_dict: dict</span>
<span class="sd">        :return: The HTTP status code of the update request if successful, or a</span>
<span class="sd">            specific negative status code indicating an error (-35 for general</span>
<span class="sd">            exceptions, -35.1 for HTTP errors).</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">field_update_dict</span><span class="p">})</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/issue/</span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Issue field updated: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">35.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error updating issue. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Field Data: </span><span class="si">{</span><span class="n">field_update_dict</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">35</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error updating issue. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Field Data: </span><span class="si">{</span><span class="n">field_update_dict</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span></div>


<div class="viewcode-block" id="JiraAPI.issue_detail">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.issue_detail">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">issue_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">issue_id</span><span class="p">,</span> <span class="n">include_forms</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the details of a Jira issue, including various metadata and optionally form responses. It fetches</span>
<span class="sd">        issue details such as reporter information, assignee information, status, and custom fields. If</span>
<span class="sd">        `include_forms` is set to `True`, it extracts additional data from Proforma forms present in the issue and</span>
<span class="sd">        merges questions and responses into a pandas DataFrame.</span>

<span class="sd">        This method makes an authenticated HTTP request to the Jira API to retrieve the specified issue&#39;s details.</span>
<span class="sd">        It processes the response to parse issue metadata and optional form-related data.</span>

<span class="sd">        :param issue_id: The unique identifier of the Jira issue</span>
<span class="sd">        :param include_forms: If set to True, retrieves and processes forms associated with the issue.</span>
<span class="sd">        :return: A named tuple containing the following elements:</span>
<span class="sd">            - `status_code` (int): The HTTP status code of the request.</span>
<span class="sd">            - `jira_issue_info_dict` (dict): Metadata and details about the Jira issue.</span>
<span class="sd">            - `jira_issue_dict` (dict): Raw API response data from Jira.</span>
<span class="sd">            - `question_response_df` (pandas.DataFrame): A DataFrame containing Proforma form responses, if `include_forms` is True.</span>
<span class="sd">        :rtype: namedtuple</span>
<span class="sd">        :raises: Handles HTTP error or generic exceptions during API requests or data processing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">issue_detail_info</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;issue_detail_info&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;status_code&quot;</span><span class="p">,</span> <span class="s2">&quot;jira_issue_info_dict&quot;</span><span class="p">,</span> <span class="s2">&quot;jira_issue_dict&quot;</span><span class="p">,</span>
                                                             <span class="s2">&quot;question_response_df&quot;</span><span class="p">])</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/issue/</span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s1">?properties=*all&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
            <span class="c1"># jiraIssueDetail_json = json.loads(jiraIssueDetail.text)</span>
            <span class="c1"># print(jiraIssueForms.text)</span>
            <span class="n">jiraIssueFormsText</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
            <span class="c1"># print(jiraIssueFormsText)</span>
            <span class="n">jira_issue_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">reporter_account_id</span> <span class="o">=</span> <span class="n">jq</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;fields.reporter.accountId&#39;</span><span class="p">,</span> <span class="n">jira_issue_dict</span><span class="p">)</span>
            <span class="n">reporter_email_address</span> <span class="o">=</span> <span class="n">jq</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;fields.reporter.emailAddress&#39;</span><span class="p">,</span> <span class="n">jira_issue_dict</span><span class="p">)</span>
            <span class="n">issue_status_id</span> <span class="o">=</span> <span class="n">jq</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;fields.status.id&#39;</span><span class="p">,</span> <span class="n">jira_issue_dict</span><span class="p">)</span>
            <span class="n">issue_status_name</span> <span class="o">=</span> <span class="n">jq</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;fields.status.name&#39;</span><span class="p">,</span> <span class="n">jira_issue_dict</span><span class="p">)</span>
            <span class="n">change_start_datetime</span> <span class="o">=</span> <span class="n">jq</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;fields.customfield_14069&#39;</span><span class="p">,</span> <span class="n">jira_issue_dict</span><span class="p">)</span>
            <span class="n">assignee_id</span> <span class="o">=</span> <span class="n">jq</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;fields.assignee.accountId&quot;</span><span class="p">,</span> <span class="n">jira_issue_dict</span><span class="p">)</span>
            <span class="n">assignee_email_address</span> <span class="o">=</span> <span class="n">jq</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;fields.assignee.emailAddress&quot;</span><span class="p">,</span> <span class="n">jira_issue_dict</span><span class="p">)</span>
            <span class="n">jira_issue_info_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;reporter_account_id&quot;</span><span class="p">:</span> <span class="n">reporter_account_id</span><span class="p">,</span>
                                    <span class="s2">&quot;reporter_email_address&quot;</span><span class="p">:</span> <span class="n">reporter_email_address</span><span class="p">,</span>
                                    <span class="s2">&quot;issue_status_id&quot;</span><span class="p">:</span> <span class="n">issue_status_id</span><span class="p">,</span>
                                    <span class="s2">&quot;issue_status_name&quot;</span><span class="p">:</span> <span class="n">issue_status_name</span><span class="p">,</span>
                                    <span class="s2">&quot;change_start_datetime&quot;</span><span class="p">:</span> <span class="n">change_start_datetime</span><span class="p">,</span>
                                    <span class="s2">&quot;assignee_id&quot;</span><span class="p">:</span> <span class="n">assignee_id</span><span class="p">,</span>
                                    <span class="s2">&quot;assignee_email_address&quot;</span><span class="p">:</span> <span class="n">assignee_email_address</span><span class="p">,</span> <span class="p">}</span>

            <span class="k">if</span> <span class="n">include_forms</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">jira_issue_properties</span> <span class="o">=</span> <span class="n">jira_issue_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;properties&#39;</span><span class="p">)</span>
                <span class="c1"># the proforma.form.i value changes as a unique identifier</span>
                <span class="n">jira_issue_forms_element</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">jira_issue_properties</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span>
                                            <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;proforma.forms.i&#39;</span><span class="p">)}</span>
                <span class="n">jira_issue_form_key</span><span class="p">,</span> <span class="n">jira_issue_forms</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">jira_issue_forms_element</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
                <span class="n">questions_list</span> <span class="o">=</span> <span class="n">jq</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;design.questions&#39;</span><span class="p">,</span> <span class="n">jira_issue_forms</span><span class="p">)</span>
                <span class="c1"># print(questions_list)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="c1"># Loop through question_list</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">questions_list</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="c1"># Append a dict containing the required information to the list</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">{</span><span class="s1">&#39;questionID&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span> <span class="s1">&#39;jiraField&#39;</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;jiraField&#39;</span><span class="p">),</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">),</span>
                         <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">),</span> <span class="s1">&#39;questionKey&#39;</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;questionKey&#39;</span><span class="p">),</span>
                         <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;choices&#39;</span><span class="p">)})</span>
                <span class="c1"># print(f&quot;{questions_list}&quot;)</span>
                <span class="c1"># Convert the list of dicts to a DataFrame</span>
                <span class="n">df_questions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

                <span class="n">responses_list</span> <span class="o">=</span> <span class="n">jq</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;state.answers&#39;</span><span class="p">,</span> <span class="n">jira_issue_forms</span><span class="p">)</span>
                <span class="c1"># print(responses_list)</span>
                <span class="n">responses_list_fmt</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="c1"># Loop through question_list</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">responses_list</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="c1"># Append a dict containing the required information to the list</span>
                    <span class="n">responses_list_fmt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">{</span><span class="s1">&#39;questionID&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span> <span class="s1">&#39;textField&#39;</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">),</span> <span class="s1">&#39;users&#39;</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">),</span>
                         <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">),</span> <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;choices&#39;</span><span class="p">),</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">),</span>
                         <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)})</span>

                <span class="c1"># print(responses_list)</span>
                <span class="c1"># Convert the list of dicts to a DataFrame</span>
                <span class="c1"># print(f&quot;responses_list_fmt: {responses_list_fmt}&quot;)</span>
                <span class="n">df_responses</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">responses_list_fmt</span><span class="p">)</span>
                <span class="c1"># combine the dataframes df_responses and df_questions</span>
                <span class="n">question_response_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_responses</span><span class="p">,</span> <span class="n">df_questions</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;questionID&#39;</span><span class="p">)</span>
                <span class="n">question_response_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;type_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">question_response_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;value_consolidated&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="c1"># print(f&quot;question_response_df: {question_response_df.to_json(orient=&#39;records&#39;)}&quot;)</span>
                <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">question_response_df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                    <span class="c1"># print(f&quot;index:{ind}&quot;)</span>
                    <span class="n">response_type</span> <span class="o">=</span> <span class="n">question_response_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">]</span>
                    <span class="c1"># print(f&quot;response_type:{response_type}&quot;)</span>
                    <span class="n">response_type_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type_ref</span><span class="p">(</span><span class="n">response_type</span><span class="p">)</span>
                    <span class="n">response_type_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type_col_ref</span><span class="p">(</span><span class="n">response_type</span><span class="p">)</span>
                    <span class="c1"># print(f&quot;response_type_col:{response_type_col}; response_type_name:{response_type_name}&quot;)</span>
                    <span class="n">question_response_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;type_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">response_type_name</span>
                    <span class="k">if</span> <span class="n">response_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;cs&#39;</span><span class="p">,</span> <span class="s1">&#39;cd&#39;</span><span class="p">,</span> <span class="s1">&#39;cl&#39;</span><span class="p">,</span> <span class="s1">&#39;cm&#39;</span><span class="p">):</span>
                        <span class="n">question_response_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;value_consolidated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
                            <span class="n">question_response_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="n">response_type_col</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;dt&#39;</span><span class="p">:</span>
                        <span class="n">question_response_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                            <span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;value_consolidated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">question_response_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">H</span><span class="si">{</span><span class="n">question_response_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">elif</span> <span class="n">response_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;cs&#39;</span><span class="p">,</span> <span class="s1">&#39;cd&#39;</span><span class="p">,</span> <span class="s1">&#39;cl&#39;</span><span class="p">,</span> <span class="s1">&#39;cm&#39;</span><span class="p">):</span>
                        <span class="n">choices_responses</span> <span class="o">=</span> <span class="n">question_response_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;choices_x&#39;</span><span class="p">]</span>
                        <span class="n">choices_options</span> <span class="o">=</span> <span class="n">question_response_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;choices_y&#39;</span><span class="p">]</span>
                        <span class="c1"># print(f&quot;choice_responses:{choices_responses}; choices_options:{choices_options}&quot;)</span>
                        <span class="k">if</span> <span class="n">choices_options</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">selected_choices</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;choice_id&#39;</span><span class="p">:</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span>
                                                <span class="n">choices_options</span> <span class="k">if</span>
                                                <span class="n">option</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">choices_responses</span><span class="p">]</span>
                            <span class="n">selected_choices_list</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">selected_choices</span><span class="p">)</span>
                            <span class="n">question_response_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;value_consolidated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_choices_list</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">question_response_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;value_consolidated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="c1"># print(f&quot;question_response_df: {question_response_df}&quot;)</span>
                <span class="k">return</span> <span class="n">issue_detail_info</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">jira_issue_info_dict</span><span class="p">,</span> <span class="n">jira_issue_dict</span><span class="p">,</span> <span class="n">question_response_df</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">question_response_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Issue detail. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Result: </span><span class="si">{</span><span class="n">jira_issue_dict</span><span class="si">}</span><span class="s2">; Detail: </span><span class="si">{</span><span class="n">jira_issue_info_dict</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">issue_detail_info</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">jira_issue_info_dict</span><span class="p">,</span> <span class="n">jira_issue_dict</span><span class="p">,</span> <span class="n">question_response_df</span><span class="p">)</span>
            <span class="c1"># print(question_response_df)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">30.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code:</span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving Issue Detail. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2"> message:</span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">question_response_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">issue_detail_info</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{},</span> <span class="n">question_response_df</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code:</span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving Issue Detail. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2"> message:</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">question_response_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">issue_detail_info</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{},</span> <span class="n">question_response_df</span><span class="p">)</span></div>


<div class="viewcode-block" id="JiraAPI.issue_add_comment">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.issue_add_comment">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">issue_add_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">issue_id</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a comment to a specified issue in the issue tracking system.</span>

<span class="sd">        This method sends a POST request to the specified issue endpoint with the</span>
<span class="sd">        given comment payload. The content of the comment is added to the issue</span>
<span class="sd">        identified by the `issue_id`. The method verifies the response, logs the success</span>
<span class="sd">        or failure event, and returns the status code based on the operation outcome.</span>

<span class="sd">        :param issue_id: The identifier of the issue to which the comment will be added</span>
<span class="sd">                        (str).</span>
<span class="sd">        :param comment: The text of the comment to be added to the issue (str).</span>
<span class="sd">        :return: The HTTP response status code of the action. Returns -33.1 in case of</span>
<span class="sd">                 an HTTP error and -33 in case of a general exception (int).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">comment</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">}],</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;paragraph&quot;</span><span class="p">}],</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;doc&quot;</span><span class="p">,</span> <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}})</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/issue/</span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s1">/comment&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added comment to issue: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Comment: </span><span class="si">{</span><span class="n">comment</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">33.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error adding comment to issue. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Comment: </span><span class="si">{</span><span class="n">comment</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">33</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error adding comment to issue. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Comment: </span><span class="si">{</span><span class="n">comment</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span></div>


<div class="viewcode-block" id="JiraAPI.issue_assign">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.issue_assign">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">issue_assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">issue_id</span><span class="p">,</span> <span class="n">accountId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns an issue to a specified user in the system using the provided issue ID and account ID.</span>
<span class="sd">        This method sends a PUT request to the respective API endpoint to assign the issue. It logs</span>
<span class="sd">        the outcome and returns the HTTP status code or a specific error code in case of a failure.</span>

<span class="sd">        :param issue_id: The unique identifier of the issue to be assigned.</span>
<span class="sd">        :type issue_id: str</span>
<span class="sd">        :param accountId: The account ID of the user to whom the issue will be assigned.</span>
<span class="sd">        :type accountId: str</span>
<span class="sd">        :return: HTTP status code if assignment is successful, -34 for a general error, or -34.1</span>
<span class="sd">                 for HTTP request-related errors.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;accountId&quot;</span><span class="p">:</span> <span class="n">accountId</span><span class="p">})</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/issue/</span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s1">/assignee&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Issue assigned: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Assignee: </span><span class="si">{</span><span class="n">accountId</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">34.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error assigning issue. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Assignee: </span><span class="si">{</span><span class="n">accountId</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">34</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error assigning issue. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Assignee: </span><span class="si">{</span><span class="n">accountId</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span></div>


<div class="viewcode-block" id="JiraAPI.issue_add_attachment">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.issue_add_attachment">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">issue_add_attachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">issue_id</span><span class="p">,</span> <span class="n">file_attachment</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds an attachment to a JIRA issue. This method uploads a file attachment to the specified</span>
<span class="sd">        JIRA issue using the JIRA REST API. The file is identified by its path, and JIRA-specific</span>
<span class="sd">        headers are configured to handle the attachment upload correctly.</span>

<span class="sd">        This method attempts to post the given file as an attachment to the JIRA issue identified</span>
<span class="sd">        by its ID. The file&#39;s application type is determined internally using a helper function.</span>

<span class="sd">        :param str issue_id: The unique identifier of the issue to which the attachment will be added.</span>
<span class="sd">        :param str file_attachment: The path to the file that needs to be attached.</span>
<span class="sd">        :return: The HTTP status code of the response for successful upload, negative values for errors.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">headers_jira_auth_upload</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
            <span class="s2">&quot;X-Atlassian-Token&quot;</span><span class="p">:</span> <span class="s2">&quot;no-check&quot;</span>
        <span class="p">}</span>
        <span class="n">application_type</span> <span class="o">=</span> <span class="n">get_file_application_type</span><span class="p">(</span><span class="n">file_attachment</span><span class="o">=</span><span class="n">file_attachment</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">file_attachment</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_attachment</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">),</span> <span class="n">application_type</span><span class="p">)}</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/issue/</span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s1">/attachments&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers_jira_auth_upload</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Issue attachment added: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Attachment: </span><span class="si">{</span><span class="n">file_attachment</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">33.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error adding attachment to issue. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Attachment: </span><span class="si">{</span><span class="n">file_attachment</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">33</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error adding attachment to issue. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Attachment: </span><span class="si">{</span><span class="n">file_attachment</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span></div>


<div class="viewcode-block" id="JiraAPI.issue_changelog">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.issue_changelog">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">issue_changelog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">issue_id</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fetches the changelog entries for a specific issue from the Jira API. The method sends</span>
<span class="sd">        a GET request to the Jira API endpoint for issue changelogs, using the provided issue ID</span>
<span class="sd">        and an optional maximum result limit. Returns a dictionary that contains the HTTP status</span>
<span class="sd">        code, retrieved changelog entries, or details about any exception encountered during the request.</span>

<span class="sd">        :param issue_id: The identifier of the issue whose changelog is to be retrieved.</span>
<span class="sd">        :type issue_id: str</span>
<span class="sd">        :param max_results: The maximum number of changelog entries to retrieve. Defaults to 1000.</span>
<span class="sd">        :type max_results: int, optional</span>
<span class="sd">        :return: A dictionary containing:</span>
<span class="sd">            - status_code (float): The HTTP status code of the response or a custom error code</span>
<span class="sd">              if an exception occurs.</span>
<span class="sd">            - changelog_entries (object): The JSON parsed changelog entries retrieved from the</span>
<span class="sd">              API, or None if an error occurs.</span>
<span class="sd">            - status_exception_comment (str): A message describing any exception encountered,</span>
<span class="sd">              or None if the request is successful.</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">changelog_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;status_code&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;changelog_entries&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;status_exception_comment&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/issue/</span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s1">/changelog?maxResults=</span><span class="si">{</span><span class="n">max_results</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="n">changelog_entries</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">changelog_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;status_code&#39;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="s1">&#39;changelog_entries&#39;</span><span class="p">:</span> <span class="n">changelog_entries</span><span class="p">})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Changelog. Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; Status Code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">changelog_dict</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">36.1</span>
            <span class="n">status_exception_comment</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error retrieving changelog. </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">status_exception_comment</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">changelog_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span><span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="n">status_code</span><span class="p">,</span> <span class="s2">&quot;status_exception_comment&quot;</span><span class="p">:</span> <span class="n">status_exception_comment</span><span class="p">})</span>
            <span class="k">return</span> <span class="n">changelog_dict</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">36</span>
            <span class="n">status_exception_comment</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error retrieving changelog. </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Issue ID: </span><span class="si">{</span><span class="n">issue_id</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">status_exception_comment</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">changelog_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span><span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="n">status_code</span><span class="p">,</span> <span class="s2">&quot;status_exception_comment&quot;</span><span class="p">:</span> <span class="n">status_exception_comment</span><span class="p">})</span>
            <span class="k">return</span> <span class="n">changelog_dict</span></div>


<div class="viewcode-block" id="JiraAPI.issue_types_user">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.issue_types_user">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">issue_types_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the issue types available for the user from the API and returns them</span>
<span class="sd">        in the specified format. The retrieval is done via a GET request to the</span>
<span class="sd">        designated endpoint. The result can be returned either as a raw dictionary or</span>
<span class="sd">        formatted as a DataFrame. Any errors during the process are handled and logged,</span>
<span class="sd">        with status codes indicating success or failure.</span>

<span class="sd">        :param as_dataframe: Determines whether the response will be converted into</span>
<span class="sd">            a pandas DataFrame or returned as a dictionary. Defaults to False.</span>
<span class="sd">            If True, the response will be formatted as a pandas DataFrame. If False,</span>
<span class="sd">            a raw dictionary is returned.</span>
<span class="sd">        :type as_dataframe: bool</span>
<span class="sd">        :return: A named tuple containing the status code and the retrieved issue types.</span>
<span class="sd">            If an error occurs during the retrieval process, the status code in the</span>
<span class="sd">            returned tuple will indicate the nature of the error, and the issue types</span>
<span class="sd">            part of the tuple will be empty.</span>
<span class="sd">        :rtype: namedtuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">IssueTypes</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;issue_types&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;status_code&quot;</span><span class="p">,</span> <span class="s2">&quot;issue_types&quot;</span><span class="p">])</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/issuetype&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="n">issue_types_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User Issue Types. Status Code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">as_dataframe</span><span class="p">:</span>
                <span class="n">issue_types</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">issue_types_dict</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">issue_types</span> <span class="o">=</span> <span class="n">issue_types_dict</span>
            <span class="k">return</span> <span class="n">IssueTypes</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">issue_types</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">61.1</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving user issue types; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">IssueTypes</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">61</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving user issue types; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">IssueTypes</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="p">[])</span></div>


<div class="viewcode-block" id="JiraAPI.issue_statuses">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.issue_statuses">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">issue_statuses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">projectLevel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves issue statuses for a project or globally based on the project-level flag.</span>

<span class="sd">        The method retrieves issue statuses data by making an HTTP GET request to the</span>
<span class="sd">        appropriate endpoint. If the `projectLevel` parameter is set to True, the request</span>
<span class="sd">        is scoped to the specific project, otherwise it retrieves the global issue statuses.</span>
<span class="sd">        The returned data can be optionally converted into a pandas DataFrame if the</span>
<span class="sd">        `as_dataframe` parameter is set to True. The result, including the HTTP status</span>
<span class="sd">        code and issue statuses data, is encapsulated in a named tuple `IssueStatuses`.</span>

<span class="sd">        :param projectLevel: A boolean indicating if the request should be scoped to the</span>
<span class="sd">            specific project (True) or retrieve global issue statuses (False).</span>
<span class="sd">        :param as_dataframe: A boolean indicating if the issue statuses data should be</span>
<span class="sd">            returned as a pandas DataFrame (True) or as a dictionary (False).</span>
<span class="sd">        :return: A named tuple `IssueStatuses`:</span>
<span class="sd">            -status_code</span>
<span class="sd">            -issue_statuses: either as a dictionary or a pandas DataFrame.</span>
<span class="sd">        :rtype: namedtuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">IssueStatuses</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;issue_statuses&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;status_code&quot;</span><span class="p">,</span> <span class="s2">&quot;issue_statuses&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">projectLevel</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/statuses/search?projectId=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">project_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/statuses/search&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="n">issue_statuses_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Issue Statuses. Status Code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">as_dataframe</span><span class="p">:</span>
                <span class="n">issue_statuses</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">issue_statuses_dict</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">issue_statuses</span> <span class="o">=</span> <span class="n">issue_statuses_dict</span>
            <span class="k">return</span> <span class="n">IssueStatuses</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">issue_statuses</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">71.1</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving user issue statuses; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">IssueStatuses</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">71</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving user issue statuses; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">IssueStatuses</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="p">[])</span></div>


<span class="w">    </span><span class="sd">&quot;&quot;&quot;Experimental as of 03/14/2025</span>
<span class="sd">    def project_issue_types(self, project_id=None, as_dataframe=False) -&gt; object:</span>

<span class="sd">        IssueTypes = namedtuple(&quot;issue_types&quot;, [&quot;status_code&quot;, &quot;issue_types&quot;])</span>
<span class="sd">        if project_id is None: project_id = self.project_id</span>
<span class="sd">        #url = f&#39;{self.base_url}api/3/issuetype/project&#39;</span>
<span class="sd">        url = f&#39;{self.base_url}api/3/issuetype&#39;</span>
<span class="sd">        #query_json = {&quot;projectId&quot;: project_id }</span>
<span class="sd">        #query = json.dumps(query_json)</span>
<span class="sd">        query = {&#39;projectId&#39;: &#39;{10000}&#39;}</span>
<span class="sd">        try:</span>
<span class="sd">            #response = requests.get(url, headers=self.headers, auth=self._auth, params=query)</span>
<span class="sd">            response = requests.get(url, headers=self.headers, auth=self._auth)</span>
<span class="sd">            response.raise_for_status()</span>
<span class="sd">            issue_types_dict = json.loads(response.text)</span>
<span class="sd">            self.logger.debug(f&quot;Project Issue Types. Issue ID: {project_id}; Status Code: {response.status_code}&quot;)</span>
<span class="sd">            if as_dataframe:</span>
<span class="sd">                jira_issues = pd.json_normalize(issue_types_dict, record_path=[&#39;issues&#39;], errors=&#39;ignore&#39;, sep=&#39;_&#39;)</span>
<span class="sd">            else:</span>
<span class="sd">                issue_types = issue_types_dict</span>
<span class="sd">            return IssueTypes(response.status_code, issue_types)</span>
<span class="sd">        except requests.exceptions.HTTPError as errh:</span>
<span class="sd">            status_code = -36</span>
<span class="sd">            logger.error(f&quot;Status Code: {status_code}; Error retrieving project issue types; Project: {project_id}; {errh}; {response.text}&quot;)</span>
<span class="sd">            return IssueTypes(status_code, [])</span>
<span class="sd">        except Exception as e:</span>
<span class="sd">            status_code = -36</span>
<span class="sd">            logger.error(f&quot;Status Code: {status_code}; Error retrieving project issue types; Project: {project_id}; {e}&quot;)</span>
<span class="sd">            return IssueTypes(status_code, [])</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="JiraAPI.role_add_user">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.role_add_user">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">role_add_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="n">accountId</span><span class="p">,</span> <span class="n">project_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a user to a specified role for a given project in the system. This method sends a POST</span>
<span class="sd">        request to the appropriate API endpoint with the required payload. The method will log</span>
<span class="sd">        relevant information and errors during the execution, returning the HTTP response status</span>
<span class="sd">        code or an error-specific code in case of failure.</span>

<span class="sd">        :param role_id: The ID of the role to which the user will be added.</span>
<span class="sd">        :type role_id: int</span>
<span class="sd">        :param accountId: The ID of the user account to be added to the role.</span>
<span class="sd">        :type accountId: str</span>
<span class="sd">        :param project_id: The ID of the project associated with the role. Defaults to the object&#39;s</span>
<span class="sd">            `project_id` if not specified.</span>
<span class="sd">        :type project_id: Optional[int]</span>
<span class="sd">        :return: The HTTP status code resulting from the API call. In case of errors, returns -51 for</span>
<span class="sd">            general exceptions or -51.1 for HTTP errors.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">project_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">project_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_id</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">accountId</span><span class="p">]})</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/project/</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s1">/role/</span><span class="si">{</span><span class="n">role_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Role Add User. Role ID: </span><span class="si">{</span><span class="n">role_id</span><span class="si">}</span><span class="s2">; Account ID: </span><span class="si">{</span><span class="n">accountId</span><span class="si">}</span><span class="s2">; Project: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">; Status Code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">51.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error adding user to role. Role ID: </span><span class="si">{</span><span class="n">role_id</span><span class="si">}</span><span class="s2">; Account ID: </span><span class="si">{</span><span class="n">accountId</span><span class="si">}</span><span class="s2">; Project: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">51</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error adding user to role. Role ID: </span><span class="si">{</span><span class="n">role_id</span><span class="si">}</span><span class="s2">; Account ID: </span><span class="si">{</span><span class="n">accountId</span><span class="si">}</span><span class="s2">; Project: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status_code</span></div>


<div class="viewcode-block" id="JiraAPI.role_get_users">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.role_get_users">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">role_get_users</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="n">project_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve the users associated with a specified Jira role for a given project.</span>

<span class="sd">        This method interacts with the Jira API to fetch details of users assigned to a specific</span>
<span class="sd">        role within a project. The fetched data includes detailed information about the</span>
<span class="sd">        users&#39; accounts and builds a DataFrame to organize the data. If the project ID</span>
<span class="sd">        is not explicitly provided, the method defaults to the project&#39;s ID already</span>
<span class="sd">        associated with the instance of the object.</span>

<span class="sd">        :param role_id: The unique identifier of the Jira role.</span>
<span class="sd">        :type role_id: str</span>
<span class="sd">        :param project_id: The unique identifier of the project, defaults to the instance&#39;s project ID.</span>
<span class="sd">        :type project_id: str, optional</span>
<span class="sd">        :return: A named tuple containing:</span>
<span class="sd">            - status_code (int): The HTTP status code of the Jira API request.</span>
<span class="sd">            - jiraRole_users_df (pandas.DataFrame): A DataFrame containing user details</span>
<span class="sd">              associated with the role in the project.</span>
<span class="sd">            - jiraRole_dict (dict): Raw dictionary data retrieved from the Jira API for the role.</span>
<span class="sd">        :rtype: object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">project_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">project_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_id</span>
        <span class="n">role_info</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;role_info&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;status_code&quot;</span><span class="p">,</span> <span class="s2">&quot;jiraRole_users_df&quot;</span><span class="p">,</span> <span class="s2">&quot;jiraRole_dict&quot;</span><span class="p">])</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/project/</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s1">/role/</span><span class="si">{</span><span class="n">role_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="n">jiraRole_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">jiraRole_users_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">jiraRole_dict</span><span class="p">,</span> <span class="n">record_path</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;actors&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="n">jiraRole_users_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;user_email&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">jiraRole_users_df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                <span class="n">accountId</span> <span class="o">=</span> <span class="n">jiraRole_users_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;actorUser_accountId&#39;</span><span class="p">]</span>
                <span class="n">user_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_info</span><span class="p">(</span><span class="n">accountId</span><span class="o">=</span><span class="n">accountId</span><span class="p">)</span>
                <span class="n">jiraRole_users_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s2">&quot;user_email&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_info</span><span class="o">.</span><span class="n">jira_user_email</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jira Role Users. Role ID: </span><span class="si">{</span><span class="n">role_id</span><span class="si">}</span><span class="s2">; Project: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">; Status Code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">role_info</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">jiraRole_users_df</span><span class="p">,</span> <span class="n">jiraRole_dict</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">50.1</span>
            <span class="n">jiraRole_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">jiraRole_users_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving Jira Role Users. Role ID: </span><span class="si">{</span><span class="n">role_id</span><span class="si">}</span><span class="s2">; Project: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">role_info</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">jiraRole_users_df</span><span class="p">,</span> <span class="n">jiraRole_dict</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span>
            <span class="n">jiraRole_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">jiraRole_users_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving Jira Role Users. Role ID: </span><span class="si">{</span><span class="n">role_id</span><span class="si">}</span><span class="s2">; Project: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">role_info</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">jiraRole_users_df</span><span class="p">,</span> <span class="n">jiraRole_dict</span><span class="p">)</span></div>


<div class="viewcode-block" id="JiraAPI.role_info">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.role_info">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">role_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="n">project_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves information about a specific Jira role in a given project. This includes details about</span>
<span class="sd">        role members and associated metadata fetched from the Jira API. The information returned is</span>
<span class="sd">        organized as a namedtuple containing the HTTP status code and a pandas DataFrame of role members.</span>

<span class="sd">        :param role_id: The unique identifier of the Jira role.</span>
<span class="sd">        :type role_id: int</span>
<span class="sd">        :param project_id: The unique identifier of the Jira project. If not provided, it defaults to None.</span>
<span class="sd">        :type project_id: Optional[int]</span>
<span class="sd">        :return: Named tuple:</span>
<span class="sd">            -status_code: the HTTP status code</span>
<span class="sd">            -jira_role_members_df: a pandas DataFrame with Jira role members.</span>
<span class="sd">        :rtype: namedtuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">role_info</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;role_info&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;status_code&quot;</span><span class="p">,</span> <span class="s2">&quot;jira_role_members_df&quot;</span><span class="p">])</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s1">api/3/project/</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s1">/role/</span><span class="si">{</span><span class="n">role_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Role Info: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">;</span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">jira_role_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">jira_role__dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
            <span class="n">jira_role_members_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">jira_role_json</span><span class="p">,</span> <span class="n">record_path</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;actors&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jira Role Info. Role ID: </span><span class="si">{</span><span class="n">role_id</span><span class="si">}</span><span class="s2">; Project: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">; Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">role_info</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">jira_role_members_df</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">errh</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mf">17.1</span>
            <span class="n">jira_role_members_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">dataframe</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving Jira Role Info. Role ID: </span><span class="si">{</span><span class="n">role_id</span><span class="si">}</span><span class="s2">; Project: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">errh</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">role_info</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">jira_role_members_df</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">17</span>
            <span class="n">jira_role_members_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">dataframe</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Code: </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">; Error retrieving Jira Role Info. Role ID: </span><span class="si">{</span><span class="n">role_id</span><span class="si">}</span><span class="s2">; Project: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">role_info</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">jira_role_members_df</span><span class="p">)</span></div>


<div class="viewcode-block" id="JiraAPI.response_type_ref">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.response_type_ref">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">response_type_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response_type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Maps a response type code to its corresponding human-readable name.</span>

<span class="sd">        This function takes a response type code and returns the corresponding</span>
<span class="sd">        string representation of the human-readable name. It uses a predefined</span>
<span class="sd">        mapping to perform this transformation. If the provided response type</span>
<span class="sd">        does not exist in the mapping, it returns `None`.</span>

<span class="sd">        :param response_type: The code representing the type of response to be mapped.</span>
<span class="sd">        :type response_type: str</span>
<span class="sd">        :return: The human-readable name associated with the response type code,</span>
<span class="sd">            or `None` if the code is not found.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response_type_name</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;ts&#39;</span><span class="p">:</span> <span class="s1">&#39;Text Short&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;cs&#39;</span><span class="p">:</span> <span class="s1">&#39;Choice Selector&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;cd&#39;</span><span class="p">:</span> <span class="s1">&#39;Choice Dropdown&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;cl&#39;</span><span class="p">:</span> <span class="s1">&#39;Choice List&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;us&#39;</span><span class="p">:</span> <span class="s1">&#39;User&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;um&#39;</span><span class="p">:</span> <span class="s1">&#39;User Multiple&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;at&#39;</span><span class="p">:</span> <span class="s1">&#39;Attachment&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="s1">&#39;Date/Time&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;da&#39;</span><span class="p">:</span> <span class="s1">&#39;Date&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;ti&#39;</span><span class="p">:</span> <span class="s1">&#39;Time&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;tl&#39;</span><span class="p">:</span> <span class="s1">&#39;Title&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;cm&#39;</span><span class="p">:</span> <span class="s1">&#39;Choice Multiple&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;pg&#39;</span><span class="p">:</span> <span class="s1">&#39;Paragraph&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">:</span> <span class="s1">&#39;Rich-Text&#39;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">response_type_name</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">response_type</span><span class="p">)</span></div>


<div class="viewcode-block" id="JiraAPI.response_type_col_ref">
<a class="viewcode-back" href="../index.html#jiraCore.JiraAPI.response_type_col_ref">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">response_type_col_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response_type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Maps a given response type to its corresponding column reference name.</span>

<span class="sd">        This function takes in a response type key (as a string) and returns the</span>
<span class="sd">        mapped column reference name corresponding to the type. The mapping is</span>
<span class="sd">        defined internally within the function through a dictionary. If the</span>
<span class="sd">        provided response type is not found in the dictionary, the function</span>
<span class="sd">        returns ``None``.</span>

<span class="sd">        :param response_type: A string representing the type of response to be</span>
<span class="sd">            mapped to a column name.</span>
<span class="sd">        :return: The column name corresponding to the given response type. If</span>
<span class="sd">            the response type is not found, returns ``None``.</span>
<span class="sd">        :rtype: str or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response_col_name</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;ts&#39;</span><span class="p">:</span> <span class="s1">&#39;textField&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;cs&#39;</span><span class="p">:</span> <span class="s1">&#39;choices_x&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;cd&#39;</span><span class="p">:</span> <span class="s1">&#39;choices_x&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;cl&#39;</span><span class="p">:</span> <span class="s1">&#39;choices_x&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;cm&#39;</span><span class="p">:</span> <span class="s1">&#39;choices_x&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;us&#39;</span><span class="p">:</span> <span class="s1">&#39;users&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;um&#39;</span><span class="p">:</span> <span class="s1">&#39;users&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;at&#39;</span><span class="p">:</span> <span class="s1">&#39;textField&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="s1">&#39;Date Time&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;da&#39;</span><span class="p">:</span> <span class="s1">&#39;date&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;ti&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;tl&#39;</span><span class="p">:</span> <span class="s1">&#39;textField&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;pg&#39;</span><span class="p">:</span> <span class="s1">&#39;textField&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">:</span> <span class="s1">&#39;textField&#39;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">response_col_name</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">response_type</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="get_file_application_type">
<a class="viewcode-back" href="../index.html#jiraCore.get_file_application_type">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_file_application_type</span><span class="p">(</span><span class="n">file_attachment</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine the MIME type (application type) of a file attachment based on its extension.</span>

<span class="sd">    This function evaluates the file extension to correctly classify its application type.</span>
<span class="sd">    If the file extension is `.mmp`, it is categorized as `application/octet-stream`.</span>
<span class="sd">    For other extensions, the function attempts to deduce the MIME type using the</span>
<span class="sd">    `mimetypes.guess_type` library. If no type is found, it defaults to `text/plain`.</span>

<span class="sd">    :param file_attachment: The file name or path representing the file attachment whose MIME</span>
<span class="sd">        type needs to be determined.</span>
<span class="sd">    :type file_attachment: str</span>
<span class="sd">    :return: The MIME type of the given file attachment.</span>
<span class="sd">    :rtype: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file_extension</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">file_attachment</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span>
    <span class="n">file_extension</span> <span class="o">=</span> <span class="n">file_extension</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">file_extension</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;mmp&#39;</span><span class="p">):</span>
        <span class="n">application_type</span> <span class="o">=</span> <span class="s1">&#39;application/octet-stream&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">application_type</span> <span class="o">=</span> <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">file_attachment</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">application_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">application_type</span> <span class="o">=</span> <span class="s1">&#39;txt/plain&#39;</span>
    <span class="k">return</span> <span class="n">application_type</span></div>

    <span class="c1"># Additional methods (e.g., attaching files, fetching changelogs, etc.) can be similarly refactored</span>

<div class="viewcode-block" id="dict_as_key_value">
<a class="viewcode-back" href="../index.html#jiraCore.dict_as_key_value">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">dict_as_key_value</span><span class="p">(</span><span class="n">input_dict</span><span class="p">,</span> <span class="n">key_as_variable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_json</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a list of dictionaries into a key-value pair dictionary, where keys are formatted</span>
<span class="sd">    based on the attribute `name` and values are derived from `id`. Provides the option to</span>
<span class="sd">    format keys as valid variables and to return the dictionary as a JSON-formatted string.</span>

<span class="sd">    :param input_dict: A list of dictionaries where each dictionary must include the attributes</span>
<span class="sd">        `name` and `id`. Each dictionary in the list is converted and aggregated into the resulting</span>
<span class="sd">        key-value pair dictionary.</span>
<span class="sd">    :type input_dict: list[dict]</span>

<span class="sd">    :param key_as_variable: A boolean flag indicating whether the keys should be formatted</span>
<span class="sd">        as valid variable names. If set to True, the keys will be formatted as lowercase with</span>
<span class="sd">        spaces replaced by underscores.</span>
<span class="sd">    :type key_as_variable: bool, optional</span>

<span class="sd">    :param as_json: A boolean flag indicating whether to return the resulting dictionary</span>
<span class="sd">        as a JSON-formatted string or as a Python dictionary.</span>
<span class="sd">    :type as_json: bool, optional</span>

<span class="sd">    :return: The resultant dictionary containing key-value pairs derived from the input list of</span>
<span class="sd">        dictionaries, formatted as requested. If `as_json` is True, the result is returned as a</span>
<span class="sd">        JSON-formatted string.</span>
<span class="sd">    :rtype: Union[dict, str]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper function to format the key as lowercase with underscores for spaces.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">key</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">key_as_variable</span> <span class="k">else</span> <span class="n">key</span>

    <span class="n">key_value_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">format_key</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]):</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">else</span> <span class="n">val</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">input_dict</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">as_json</span><span class="p">:</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">key_value_dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">key_value_dict</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">jira</span> <span class="o">=</span> <span class="n">JiraAPI</span><span class="p">()</span>
    <span class="n">input_variable</span> <span class="o">=</span> <span class="s1">&#39;This is a test issue.&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">jira</span><span class="o">.</span><span class="n">issue_add_comment</span><span class="p">(</span><span class="n">issue_id</span><span class="o">=</span><span class="mi">10004</span><span class="p">,</span><span class="n">comment</span><span class="o">=</span><span class="s1">&#39;test comment&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="c1">#print(f&quot;id: {response.id}; key: {response.key}; info:{response.issue_info}; url: {response.issue_url}&quot;)</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">jiraCore 1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">jiraCore</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, Ryan Forsythe.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>